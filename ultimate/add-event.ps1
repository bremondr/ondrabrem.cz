param([string]$EventName, [string]$FolderPath); if(-not $EventName -or -not $FolderPath){Write-Host "Usage: .\add-event.ps1 -EventName 'Event Name' -FolderPath 'path/to/folder'"; exit}; $absPath = Resolve-Path $FolderPath -ErrorAction Stop; $folder = Split-Path -Leaf $absPath; $images = @(Get-ChildItem $absPath -File | Where-Object {$_.Extension -match '\.(jpg|jpeg|png|webp|gif)$'} | Sort-Object Name | Select-Object -ExpandProperty Name); $jsonPath = "images/images.json"; $content = Get-Content $jsonPath -Raw; $json = $content | ConvertFrom-Json; if(-not $json.events){$json | Add-Member -NotePropertyName events -NotePropertyValue @()}; $existingIdx = -1; for($i = 0; $i -lt $json.events.Count; $i++){if($json.events[$i].folder -eq $folder){$existingIdx = $i; break}}; if($existingIdx -ge 0){$json.events[$existingIdx].name = $EventName; $json.events[$existingIdx].images = $images} else {$json.events += [PSCustomObject]@{name=$EventName; folder=$folder; images=$images}}; $json | ConvertTo-Json -Depth 10 | Out-File $jsonPath -Encoding UTF8; Write-Host "[OK] Event '$EventName' added/updated with $($images.Count) images"
